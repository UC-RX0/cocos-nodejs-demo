{"version":3,"sources":["file:///D:/CocosProject/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Scene/LoginManager.ts"],"names":["_decorator","Component","director","EditBox","NetworkManager","ApiMsgEnum","DataManager","SceneEnum","ccclass","property","LoginManager","editBox","onLoad","getComponentInChildren","preloadScene","Hall","start","Instance","connect","handleClick","nickname","string","inConnection","console","log","length","success","error","res","callApi","ApiPlayerJoin","playerID","player","id","loadScene"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,O,OAAAA,O;;AACjCC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,U,iBAAAA,U;;AACFC,MAAAA,W;;AACEC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;8BAGjBU,Y,WADZF,OAAO,CAAC,cAAD,C,gBAAR,MACaE,YADb,SACkCT,SADlC,CAC4C;AAAA;AAAA;AAAA,eACxCU,OADwC;AAAA;;AAExCC,QAAAA,MAAM,GAAS;AACX,eAAKD,OAAL,GAAe,KAAKE,sBAAL,CAA4BV,OAA5B,CAAf;AACAD,UAAAA,QAAQ,CAACY,YAAT,CAAsB;AAAA;AAAA,sCAAUC,IAAhC;AACH;;AACKC,QAAAA,KAAK,GAAG;AAAA;AACV,kBAAM;AAAA;AAAA,kDAAeC,QAAf,CAAwBC,OAAxB,EAAN;AADU;AAEb;;AACKC,QAAAA,WAAW,GAAG;AAAA;;AAAA;AAChB,gBAAMC,QAAQ,GAAG,KAAI,CAACT,OAAL,CAAaU,MAA9B;;AACA,gBAAI,CAAC;AAAA;AAAA,kDAAeJ,QAAf,CAAwBK,YAA7B,EAA2C;AACvCC,cAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA,oBAAM;AAAA;AAAA,oDAAeP,QAAf,CAAwBC,OAAxB,EAAN;AACA;AACH;;AACD,gBAAIE,QAAQ,CAACK,MAAT,KAAoB,CAAxB,EAA2B;AACvBF,cAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACA;AACH;;AACD,gBAAM;AAAEE,cAAAA,OAAF;AAAWC,cAAAA,KAAX;AAAkBC,cAAAA;AAAlB,sBAAgC;AAAA;AAAA,kDAAeX,QAAf,CAAwBY,OAAxB,CAAgC;AAAA;AAAA,0CAAWC,aAA3C,EAA0D;AAC5FV,cAAAA;AAD4F,aAA1D,CAAtC;;AAGA,gBAAI,CAACM,OAAL,EAAc;AACVH,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBG,KAApB;AACA;AACH;;AAGD;AAAA;AAAA,4CAAYV,QAAZ,CAAqBc,QAArB,GAAgCH,GAAG,CAACI,MAAJ,CAAWC,EAA3C;AACAV,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBI,GAAG,CAACI,MAAJ,CAAWC,EAA/B;AACA/B,YAAAA,QAAQ,CAACgC,SAAT,CAAmB;AAAA;AAAA,wCAAUnB,IAA7B;AAtBgB;AAuBnB;;AAhCuC,O","sourcesContent":["import { Player } from './../../../../server/src/Biz/Player';\r\nimport { _decorator, Component, director, EditBox, Node, Scene } from 'cc';\r\nimport { NetworkManager } from '../Global/NetworkManager';\r\nimport { ApiMsgEnum } from '../Common';\r\nimport DataManager from '../Global/DataManager';\r\nimport { SceneEnum } from '../Enum';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LoginManager')\r\nexport class LoginManager extends Component {\r\n    editBox: EditBox\r\n    onLoad(): void {\r\n        this.editBox = this.getComponentInChildren(EditBox);\r\n        director.preloadScene(SceneEnum.Hall)\r\n    }\r\n    async start() {\r\n        await NetworkManager.Instance.connect();\r\n    }\r\n    async handleClick() {\r\n        const nickname = this.editBox.string;\r\n        if (!NetworkManager.Instance.inConnection) {\r\n            console.log(\"未连接\");\r\n            await NetworkManager.Instance.connect();\r\n            return;\r\n        }\r\n        if (nickname.length === 0) {\r\n            console.log(\"请输入昵称\");\r\n            return;\r\n        }\r\n        const { success, error, res } = await NetworkManager.Instance.callApi(ApiMsgEnum.ApiPlayerJoin, {\r\n            nickname\r\n        });\r\n        if (!success) {\r\n            console.log(\"加入失败\", error);\r\n            return;\r\n        }\r\n\r\n\r\n        DataManager.Instance.playerID = res.player.id\r\n        console.log(\"加入成功\", res.player.id);\r\n        director.loadScene(SceneEnum.Hall)\r\n    }\r\n\r\n\r\n}"]}