{"version":3,"sources":["file:///D:/CocosProject/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Global/EventManager.ts"],"names":["EventManager","Singleton","map","Map","Instance","GetInstance","on","event","cb","ctx","has","get","push","set","off","index","findIndex","i","splice","emit","params","forEach","apply","clear"],"mappings":";;;yCAQqBA,Y;;;;;;;;;;;;;;;;;;AARdC,MAAAA,S;;;;;;;yBAQcD,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,kCAAqC;AAAA;AAAA;AAAA,eAK1CE,GAL0C,GAKN,IAAIC,GAAJ,EALM;AAAA;;AAC/B,mBAARC,QAAQ,GAAG;AACpB,iBAAO,MAAMC,WAAN,EAAP;AACD;;AAIDC,QAAAA,EAAE,CAACC,KAAD,EAAmBC,EAAnB,EAAiCC,GAAjC,EAA+C;AAC/C,cAAI,KAAKP,GAAL,CAASQ,GAAT,CAAaH,KAAb,CAAJ,EAAyB;AACvB,iBAAKL,GAAL,CAASS,GAAT,CAAaJ,KAAb,EAAoBK,IAApB,CAAyB;AAAEJ,cAAAA,EAAF;AAAMC,cAAAA;AAAN,aAAzB;AACD,WAFD,MAEO;AACL,iBAAKP,GAAL,CAASW,GAAT,CAAaN,KAAb,EAAoB,CAAC;AAAEC,cAAAA,EAAF;AAAMC,cAAAA;AAAN,aAAD,CAApB;AACD;AACF;;AAEDK,QAAAA,GAAG,CAACP,KAAD,EAAmBC,EAAnB,EAAiCC,GAAjC,EAA+C;AAChD,cAAI,KAAKP,GAAL,CAASQ,GAAT,CAAaH,KAAb,CAAJ,EAAyB;AACvB,gBAAMQ,KAAK,GAAG,KAAKb,GAAL,CAASS,GAAT,CAAaJ,KAAb,EAAoBS,SAApB,CAA+BC,CAAD,IAAOT,EAAE,KAAKS,CAAC,CAACT,EAAT,IAAeS,CAAC,CAACR,GAAF,KAAUA,GAA9D,CAAd;AACAM,YAAAA,KAAK,GAAG,CAAC,CAAT,IAAc,KAAKb,GAAL,CAASS,GAAT,CAAaJ,KAAb,EAAoBW,MAApB,CAA2BH,KAA3B,EAAkC,CAAlC,CAAd;AACD;AACF;;AAEDI,QAAAA,IAAI,CAACZ,KAAD,EAAyC;AAAA,4CAAnBa,MAAmB;AAAnBA,YAAAA,MAAmB;AAAA;;AAC3C,cAAI,KAAKlB,GAAL,CAASQ,GAAT,CAAaH,KAAb,CAAJ,EAAyB;AACvB,iBAAKL,GAAL,CAASS,GAAT,CAAaJ,KAAb,EAAoBc,OAApB,CAA4B,QAAiB;AAAA,kBAAhB;AAAEb,gBAAAA,EAAF;AAAMC,gBAAAA;AAAN,eAAgB;AAC3CD,cAAAA,EAAE,CAACc,KAAH,CAASb,GAAT,EAAcW,MAAd;AACD,aAFD;AAGD;AACF;;AAEDG,QAAAA,KAAK,GAAG;AACN,eAAKrB,GAAL,CAASqB,KAAT;AACD;;AAhCiD,O","sourcesContent":["import Singleton from \"../Base/Singleton\";\nimport { EventEnum } from \"../Enum\";\n\ninterface IItem {\n  cb: Function;\n  ctx: unknown;\n}\n\nexport default class EventManager extends Singleton {\n  static get Instance() {\n    return super.GetInstance<EventManager>();\n  }\n\n  private map: Map<EventEnum, Array<IItem>> = new Map();\n\n  on(event: EventEnum, cb: Function, ctx: unknown) {\n    if (this.map.has(event)) {\n      this.map.get(event).push({ cb, ctx });\n    } else {\n      this.map.set(event, [{ cb, ctx }]);\n    }\n  }\n\n  off(event: EventEnum, cb: Function, ctx: unknown) {\n    if (this.map.has(event)) {\n      const index = this.map.get(event).findIndex((i) => cb === i.cb && i.ctx === ctx);\n      index > -1 && this.map.get(event).splice(index, 1);\n    }\n  }\n\n  emit(event: EventEnum, ...params: unknown[]) {\n    if (this.map.has(event)) {\n      this.map.get(event).forEach(({ cb, ctx }) => {\n        cb.apply(ctx, params);\n      });\n    }\n  }\n\n  clear() {\n    this.map.clear();\n  }\n}\n"]}