{"version":3,"sources":["file:///D:/CocosProject/cocos-nodejs-io-game-start-demo-master/apps/client/extensions/Behavior%20Eden/src/runtime/node/composite/RandomSequence.ts"],"names":["Composite","NodeStatus","btclass","RandomSequence","executionOrder","index","length","onStart","shuffle","canExecute","Boolean","status","Failure","onChildExecuted","_","pop","onConditionalAbort","Inactive","indexList","Array","from","children","e","i","num","Math","floor","random","push","splice"],"mappings":";;;;;;;;;AAASA,MAAAA,S,gBAAAA,S;AAAWC,MAAAA,U,gBAAAA,U;;AACXC,MAAAA,O,iBAAAA,O;;;;;yBAGYC,c,WADpBD,OAAO,CAAC,gBAAD,C,gBAAR,MACqBC,cADrB,SAC4CH,SAD5C,CACsD;AAAA;AAAA;AAAA,eACpDI,cADoD,GACpB,EADoB;AAAA;;AAG3C,YAALC,KAAK,GAAG;AACV,iBAAO,KAAKD,cAAL,CAAoB,KAAKA,cAAL,CAAoBE,MAApB,GAA6B,CAAjD,CAAP;AACD;;AAEDC,QAAAA,OAAO,GAAS;AACd,gBAAMA,OAAN;AACA,eAAKC,OAAL;AACD;;AAEDC,QAAAA,UAAU,GAAY;AACpB,iBAAOC,OAAO,CAAC,KAAKN,cAAL,CAAoBE,MAArB,CAAP,IAAuC,KAAKK,MAAL,KAAgBV,UAAU,CAACW,OAAzE;AACD;;AAEDC,QAAAA,eAAe,CAACF,MAAD,EAAqBG,CAArB,EAAsC;AACnD,eAAKV,cAAL,CAAoBW,GAApB;AACA,eAAKJ,MAAL,GAAcA,MAAd;AACD;;AAEDK,QAAAA,kBAAkB,GAAG;AACnB,eAAKZ,cAAL,GAAsB,EAAtB;AACA,eAAKO,MAAL,GAAcV,UAAU,CAACgB,QAAzB;AACA,eAAKT,OAAL;AACD;;AAEDA,QAAAA,OAAO,GAAG;AACR,eAAKJ,cAAL,GAAsB,EAAtB;AACA,gBAAMc,SAAS,GAAGC,KAAK,CAACC,IAAN,CAAW;AAAEd,YAAAA,MAAM,EAAE,KAAKe,QAAL,CAAcf;AAAxB,WAAX,EAA6C,CAACgB,CAAD,EAAIC,CAAJ,KAAUA,CAAvD,CAAlB;;AACA,eAAK,IAAIA,CAAC,GAAGL,SAAS,CAACZ,MAAV,GAAmB,CAAhC,EAAmCiB,CAAC,IAAI,CAAxC,EAA2CA,CAAC,EAA5C,EAAgD;AAC9C,kBAAMC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBT,SAAS,CAACZ,MAArC,CAAZ;AACA,iBAAKF,cAAL,CAAoBwB,IAApB,CAAyBV,SAAS,CAACW,MAAV,CAAiBL,GAAjB,EAAsB,CAAtB,EAAyB,CAAzB,CAAzB;AACD;AACF;;AAlCmD,O","sourcesContent":["import { Composite, NodeStatus } from \"../index\";\r\nimport { btclass } from \"../../core/decorator\";\r\n\r\n@btclass(\"RandomSequence\")\r\nexport default class RandomSequence extends Composite {\r\n  executionOrder: Array<number> = [];\r\n\r\n  get index() {\r\n    return this.executionOrder[this.executionOrder.length - 1];\r\n  }\r\n\r\n  onStart(): void {\r\n    super.onStart();\r\n    this.shuffle();\r\n  }\r\n\r\n  canExecute(): boolean {\r\n    return Boolean(this.executionOrder.length) && this.status !== NodeStatus.Failure;\r\n  }\r\n\r\n  onChildExecuted(status: NodeStatus, _: number): void {\r\n    this.executionOrder.pop();\r\n    this.status = status;\r\n  }\r\n\r\n  onConditionalAbort() {\r\n    this.executionOrder = [];\r\n    this.status = NodeStatus.Inactive;\r\n    this.shuffle();\r\n  }\r\n\r\n  shuffle() {\r\n    this.executionOrder = [];\r\n    const indexList = Array.from({ length: this.children.length }, (e, i) => i);\r\n    for (let i = indexList.length - 1; i >= 0; i--) {\r\n      const num = Math.floor(Math.random() * indexList.length);\r\n      this.executionOrder.push(indexList.splice(num, 1)[0]);\r\n    }\r\n  }\r\n}\r\n"]}