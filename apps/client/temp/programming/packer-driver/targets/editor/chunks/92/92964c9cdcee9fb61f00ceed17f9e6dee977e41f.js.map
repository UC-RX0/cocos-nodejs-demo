{"version":3,"sources":["file:///D:/CocosProject/cocos-nodejs-io-game-start-demo-master/apps/client/assets/Scripts/Entity/Explosion/ExplosionStateMachine.ts"],"names":["_decorator","Animation","AnimationClip","EntityStateEnum","ParamsNameEnum","StateMachine","getInitParamsTrigger","State","ObjectPoolManager","ccclass","property","ExplosionStateMachine","init","type","animationComponent","node","addComponent","initParams","initStateMachines","initAnimationEvent","params","set","Idle","stateMachines","WrapMode","Normal","on","EventType","FINISHED","Instance","ret","run","currentState","get"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;;AAEvBC,MAAAA,e,iBAAAA,e;AAAiBC,MAAAA,c,iBAAAA,c;;AACnBC,MAAAA,Y;AAAgBC,MAAAA,oB,iBAAAA,oB;;AAChBC,MAAAA,K;;AACAC,MAAAA,iB;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;uCAEaW,qB,WADZF,OAAO,CAAC,uBAAD,C,gBAAR,MACaE,qBADb;AAAA;AAAA,wCACwD;AACpDC,QAAAA,IAAI,CAACC,IAAD,EAAuB;AACvB,eAAKA,IAAL,GAAYA,IAAZ;AACA,eAAKC,kBAAL,GAA0B,KAAKC,IAAL,CAAUC,YAAV,CAAuBf,SAAvB,CAA1B;AACA,eAAKgB,UAAL;AACA,eAAKC,iBAAL;AACA,eAAKC,kBAAL;AACH;;AAEDF,QAAAA,UAAU,GAAG;AACT,eAAKG,MAAL,CAAYC,GAAZ,CAAgB;AAAA;AAAA,gDAAeC,IAA/B,EAAqC;AAAA;AAAA,6DAArC;AACH;;AAEDJ,QAAAA,iBAAiB,GAAG;AAChB,eAAKK,aAAL,CAAmBF,GAAnB,CAAuB;AAAA;AAAA,gDAAeC,IAAtC,EAA4C;AAAA;AAAA,8BAAU,IAAV,EAAiB,GAAE,KAAKT,IAAK,GAAE;AAAA;AAAA,kDAAgBS,IAAK,EAApD,EAAuDpB,aAAa,CAACsB,QAAd,CAAuBC,MAA9E,CAA5C;AACH;;AAEDN,QAAAA,kBAAkB,GAAG;AACjB,eAAKL,kBAAL,CAAwBY,EAAxB,CAA2BzB,SAAS,CAAC0B,SAAV,CAAoBC,QAA/C,EAAyD,MAAM;AAC3D;AAAA;AAAA,wDAAkBC,QAAlB,CAA2BC,GAA3B,CAA+B,KAAKf,IAApC;AACH,WAFD,EAEG,IAFH;AAGH;;AAIDgB,QAAAA,GAAG,GAAG;AACF,kBAAQ,KAAKC,YAAb;AACI,iBAAK,KAAKT,aAAL,CAAmBU,GAAnB,CAAuB;AAAA;AAAA,kDAAeX,IAAtC,CAAL;AACA;AACI,mBAAKU,YAAL,GAAoB,KAAKT,aAAL,CAAmBU,GAAnB,CAAuB;AAAA;AAAA,oDAAeX,IAAtC,CAApB;AACA;AAJR;AAMH;;AAhCmD,O","sourcesContent":["import { _decorator, Animation, AnimationClip } from 'cc';\r\nimport { EntityTypeEnum, IActor, InputTypeEnum } from '../../Common';\r\nimport { EntityStateEnum, ParamsNameEnum } from '../../Enum';\r\nimport StateMachine, { getInitParamsTrigger } from '../../Base/StateMachine';\r\nimport State from '../../Base/State';\r\nimport ObjectPoolManager from '../../Global/ObjectPoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * @description 玩家状态机\r\n * 自己的理解:ActorStateMachine就是玩家自己的状态机, 凡是想使用动画系统的\r\n * 都必须在原有的UI控件基础上附带这个状态机信息 这个状态机系统的设定是使用了类混合树(不确定)\r\n * 就像创建动画系统一样 设置触发条件(Parames 状态名称 类型 数值) 设置状态机(StateMachine 总系统)\r\n * 子系统共有两个节点  子状态机(SubstateMachine 子系统附属于StateMachine)可包含state  state(子系统附属于SubstateMachine和stateMachine)\r\n * 可以理解为 单一状态机就设置为state 多状态就设置为SubstateMachine(含有state) 故我称之为类混合树\r\n * 其触发条件十分简单 首先是需要设置好状态机(参数 state substatemachine) 通过setParams\r\n * 触发总状态机 stateMachine的run方法 修改currentState选择当前状态机(state 或者是 subStateMachine 接着传递到state)\r\n * 来进行run方法(state为最终承接者) state采用对象轨道(改变对象的属性值)来完成动画系统\r\n * \r\n *\r\n */\r\n@ccclass('ExplosionStateMachine')\r\nexport class ExplosionStateMachine extends StateMachine {\r\n    init(type: EntityTypeEnum) {\r\n        this.type = type;\r\n        this.animationComponent = this.node.addComponent(Animation);\r\n        this.initParams();\r\n        this.initStateMachines();\r\n        this.initAnimationEvent();\r\n    }\r\n\r\n    initParams() {\r\n        this.params.set(ParamsNameEnum.Idle, getInitParamsTrigger());\r\n    }\r\n\r\n    initStateMachines() {\r\n        this.stateMachines.set(ParamsNameEnum.Idle, new State(this, `${this.type}${EntityStateEnum.Idle}`, AnimationClip.WrapMode.Normal));\r\n    }\r\n\r\n    initAnimationEvent() {\r\n        this.animationComponent.on(Animation.EventType.FINISHED, () => {\r\n            ObjectPoolManager.Instance.ret(this.node)\r\n        }, this);\r\n    }\r\n\r\n\r\n\r\n    run() {\r\n        switch (this.currentState) {\r\n            case this.stateMachines.get(ParamsNameEnum.Idle):\r\n            default:\r\n                this.currentState = this.stateMachines.get(ParamsNameEnum.Idle);\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}